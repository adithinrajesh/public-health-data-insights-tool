<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Filter Patients</title>

<style>
    body {
        background: #f4f5f7;
        font-family: Arial, sans-serif;
        margin: 0;
    }

    header {
        background: #2c3e50;
        color: white;
        padding: 20px;
        position: relative;
        text-align: center;
    }

    .back-btn {
        position: absolute;
        left: 20px;
        top: 20px;
        padding: 10px 20px;
        background: #555;
        color: white;
        border-radius: 5px;
        text-decoration: none;
    }

    .container {
        width: 90%;
        max-width: 1000px;
        margin: 25px auto;
        background: white;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .section-title {
        font-weight: bold;
        margin-top: 15px;
    }

    input, select {
        width: 250px;
        padding: 10px;
        margin-top: 5px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }

    .filter-row {
        margin-bottom: 15px;
    }

    button {
        margin-top: 20px;
        padding: 12px 25px;
        font-size: 16px;
        background: #3498db;
        border: none;
        color: white;
        border-radius: 8px;
        cursor: pointer;
        margin-right: 10px;
    }

    .table-wrapper {
        margin-top: 25px;
        overflow-x: auto;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        background: white;
    }

    th, td {
        padding: 10px;
        border: 1px solid #ddd;
        white-space: nowrap;
    }

    th {
        background: #2c3e50;
        color: white;
    }

    .alert {
        margin-top: 20px;
        padding: 12px;
        background: #ffdddd;
        border-left: 4px solid red;
        border-radius: 5px;
    }
</style>

<script>
let currentPage = 1;       // current page number
const rowsPerPage = 50;    // rows per page

function resetFilters() {
    document.getElementById("min_age").value = "";
    document.getElementById("max_age").value = "";
    document.getElementById("gender").value = "";
    document.getElementById("hospital").value = "";
    document.getElementById("condition").value = "";
    document.getElementById("doctor").value = "";
    document.getElementById("ad_start").value = "";
    document.getElementById("ad_end").value = "";
    document.getElementById("bill_min").value = "";
    document.getElementById("bill_max").value = "";
    currentPage = 1;
    applyFilters();
}

async function goToPage(page) {
    currentPage = page;
    await applyFilters();
}

async function applyFilters() {
    const payload = {
        min_age: document.getElementById("min_age").value,
        max_age: document.getElementById("max_age").value,
        gender: document.getElementById("gender").value,
        hospital: document.getElementById("hospital").value,
        condition: document.getElementById("condition").value,
        doctor: document.getElementById("doctor").value,
        ad_start: document.getElementById("ad_start").value,
        ad_end: document.getElementById("ad_end").value,
        bill_min: document.getElementById("bill_min").value,
        bill_max: document.getElementById("bill_max").value,
        page: currentPage,
        per_page: rowsPerPage
    };

    const response = await fetch("/filter", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(payload)
    });

    const html = await response.text();
    document.getElementById("results").innerHTML = html;
}
</script>

</head>
<body>

<header>
    <a href="/" class="back-btn">â¬… Home</a>
    <h1>Patient Filtering</h1>
</header>

<div class="container">

    <div class="filter-row">
        <div class="section-title">Age Range</div>
        <input type="number" id="min_age" placeholder="Min Age">
        <input type="number" id="max_age" placeholder="Max Age">
    </div>

    <div class="filter-row">
        <div class="section-title">Gender</div>
        <select id="gender">
            <option value="">--Any--</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
        </select>
    </div>

    <div class="filter-row">
        <div class="section-title">Hospital</div>
        <input type="text" id="hospital" placeholder="Hospital Name">
    </div>

    <div class="filter-row">
        <div class="section-title">Medical Condition</div>
        <input type="text" id="condition" placeholder="Condition Name">
    </div>

    <div class="filter-row">
        <div class="section-title">Doctor</div>
        <input type="text" id="doctor" placeholder="Doctor Name">
    </div>

    <div class="filter-row">
        <div class="section-title">Admission Date</div>
        <input type="date" id="ad_start"> to
        <input type="date" id="ad_end">
    </div>

    <div class="filter-row">
        <div class="section-title">Billing Range</div>
        <input type="number" id="bill_min" placeholder="Min Amount">
        <input type="number" id="bill_max" placeholder="Max Amount">
    </div>

    <button onclick="applyFilters()">Apply Filters</button>
    <button type="button" onclick="resetFilters()">Reset All Filters</button>

    <div class="table-wrapper" id="results"></div>

</div>

</body>
</html>
